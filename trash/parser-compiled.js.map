{"version":3,"sources":["parser.js"],"names":[],"mappings":"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","file":"parser-compiled.js","sourcesContent":["var express = require('express');\nvar app = express();\nconst VK = require('vk-io');\nconst vk = new VK({\n    app: 5980502,\n    login: '',\n    pass: '',\n    phone: '',\n    scope: 'stats,notifications,groups,wall,pages,friends,offline,photos,market'\n});\nvar jquery = require('jquery');\nvar Nightmare = require('nightmare');\nnightmare = Nightmare();\n//var ABC = [\"в\",\"с\",\"до\",\"от\",\"2017\",\"по\",\"на\",\"за\",\"для\",\"фестиваль\",\"день\",\"уроки\",\"встреча\",\"отдых\",\"МК\"];\nvar groupID = [];\nvar groupName = [];\nvar groupActivity = [];\nvar groupPhoto = [];\nvar groupStartdate= [];\nvar groupLatitude = [];\nvar groupLongitude = [];\n\nvar CitiesID = ['96'];\nvar ABC = [\"в\"];\n\n\n\n\n\n\n//в,с,до,от,2017,по,на,за,для,фестиваль,день,уроки,встреча,отдых,МК\n\nconst auth = vk.auth.standalone();\n\nfunction arrayUnique(arr){\n    return arr.filter((e,i,a)=>a.indexOf(e)==i)\n}\nfunction compareStart(eventA, eventB) {\n    return eventA.start - eventB.start;\n}\n\nfunction parseDataFromSite(c) {\n    return function () {\n        nightmare.goto('https://vk.com/search?c%5Bcity%5D=' + CitiesID[c] + '&c%5Bcountry%5D=1&c%5Bsection%5D=communities&c%5Bskip_catalog%5D=1&c%5Btype%5D=3')\n            .wait(2000) // c\n            .inject('js', './jquery_v1_10_2.js')\n            .wait(2000)\n            .scrollTo(9999999999999999999999999999999,0)\n            .wait(5000)\n            .evaluate(function () {\n                var shortNames = [];\n                $('.labeled.title a').each(function () {\n                    var item = $(this).attr('href');\n                    $.trim(item);\n                    item = item.replace('/','');\n                    item = item.replace('event','club');\n                    shortNames.push(item)\n                });\n\n                shortNames = shortNames.join(',');\n\n                return new Promise(function (resolve, reject) {\n                    setTimeout(() => resolve(shortNames), 1000);\n                })\n            })\n            .then(function (result) {\n                return new Promise(function (resolve, reject) {\n                    console.info(result);\n                    vk.api.groups.getById({\n                            group_ids: result,\n                            fields: 'members_count,start_date,activity,place'\n                        })\n                        .then((data) => {\n                            console.log(data);\n\n                            var Event = {\n                                id: String,\n                                name: String,\n                                activity: String,\n                                photo: String,\n                                start: Number,\n                                members: Number,\n                                latitude: Number,\n                                longitude: Number\n                            };\n\n                            var gLatitude = 0;\n                            var gLongitude = 0;\n\n                            var dataObj = JSON.stringify(data);\n                            var dataJSON = JSON.parse(dataObj);\n                            for (var i = 0; i < dataJSON.length; i++) {\n\n                                //groupID.push(dataJSON[i].id);\n                                var place = dataJSON[i].place;\n                                if (place) {\n                                    gLatitude = dataJSON[i].place.latitude;\n                                    gLongitude = dataJSON[i].place.longitude;\n                                } else {\n                                    console.info('Адрес проведения мероприятий не указан организаторами');\n                                }\n\n                                Event[i] = {\n                                    id: dataJSON[i].id,\n                                    name: dataJSON[i].name,\n                                    activity: dataJSON[i].activity,\n                                    photo: dataJSON[i].photo_200,\n                                    start: dataJSON[i].start_date,\n                                    members: dataJSON[i].members_count,\n                                    latitude: gLatitude,\n                                    longitude: gLongitude\n                                };\n\n                                var eventEx = Event[i];\n                                var eventsArr = [];\n                                eventsArr.push(eventEx);\n                            }\n                            eventsArr.sort(compareStart); // массив объектов отсортированный по дате старта\n\n                            resolve(eventsArr);\n                        })\n                })\n            })\n            .then(function (events) { // запись в базу данных с сайта\n                for (var i=0; i<events.length; i++) {\n                    console.log(events[i].name);\n                }\n                //console.log(groupPhoto);\n            })\n    }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction parseDataAndRecord(j,c) {\n    return function () {\n        nightmare.goto('https://vk.com/search?c%5Bcity%5D=' + CitiesID[c] + '&c%5Bcountry%5D=1&c%5Bsection%5D=communities&c%5Bskip_catalog%5D=1&c%5Btype%5D=3')\n            .wait(2000) // c\n            .inject('js', './jquery_v1_10_2.js')\n            .wait(2000)\n            .scrollTo(9999999999999999999999999999999,0)\n            .wait(5000)\n            .evaluate(function () {\n                var shortNames = [];\n                $('.labeled.title a').each(function () {\n                    var item = $(this).attr('href');\n                    $.trim(item);\n                    item = item.replace('/','');\n                    item = item.replace('event','club');\n                    shortNames.push(item)\n                });\n\n                shortNames = shortNames.join(',');\n\n                return new Promise(function (resolve, reject) {\n                    setTimeout(() => resolve(shortNames), 1000);\n                })\n            })\n            .then(function (result) {\n                return new Promise(function (resolve, reject) {\n                    console.info(result);\n                    vk.api.groups.getById({\n                            group_ids: result,\n                            fields: 'members_count,start_date,activity,place'\n                        })\n                        .then((data) => {\n                            console.log(data);\n\n                            var Event = {\n                                id: String,\n                                name: String,\n                                activity: String,\n                                photo: String,\n                                start: Number,\n                                members: Number,\n                                latitude: Number,\n                                longitude: Number\n                            };\n\n                            var gLatitude = 0;\n                            var gLongitude = 0;\n\n                            var dataObj = JSON.stringify(data);\n                            var dataJSON = JSON.parse(dataObj);\n                            for (var i = 0; i < dataJSON.length; i++) {\n\n                                //groupID.push(dataJSON[i].id);\n                                var place = dataJSON[i].place;\n                                if (place) {\n                                    gLatitude = dataJSON[i].place.latitude;\n                                    gLongitude = dataJSON[i].place.longitude;\n                                } else {\n                                    console.info('Адрес проведения мероприятий не указан организаторами');\n                                }\n\n                                Event[i] = {\n                                    id: dataJSON[i].id,\n                                    name: dataJSON[i].name,\n                                    activity: dataJSON[i].activity,\n                                    photo: dataJSON[i].photo_200,\n                                    start: dataJSON[i].start_date,\n                                    members: dataJSON[i].members_count,\n                                    latitude: gLatitude,\n                                    longitude: gLongitude\n                                };\n\n                                var eventEx = Event[i];\n                                var eventsArr = [];\n                                eventsArr.push(eventEx);\n                            }\n                            eventsArr.sort(compareStart); // массив объектов отсортированный по дате старта\n\n                            resolve(eventsArr);\n                        })\n                })\n            })\n            .then(function (events) { // запись в базу данных с сайта\n                for (var i=0; i<events.length; i++) {\n                    console.log(events[i].name);\n                }\n                //console.log(groupPhoto);\n            })\n            // конец парсера начало API\n            .then(function () {\n                auth.run()\n                    .then((token) => {\n                        console.log('User token:', token);\n                        vk.setToken(token);\n                        vk.api.groups.search({\n                                q: ABC[j], // j\n                                type: 'event',\n                                city_id: CitiesID[c], // c\n                                future: 1,\n                                offset: 0,\n                                count: 1000\n                            })\n                            .then((group) => {\n                                var result = [];\n                                console.log('Первое поиское слово: ', ABC[j]); // j\n                                var groupObj = JSON.stringify(group);\n                                var groupJSON = JSON.parse(groupObj);\n                                for (var i = 0; i < groupJSON.items.length; i++) {\n                                    result.push(groupJSON.items[i].screen_name); // все id по словарю для заданного города\n                                }\n                                result = arrayUnique(result); // удаляем дублирующиеся данные\n                                return result;\n                            })\n                            .then(function (result) {\n                                return new Promise(function (resolve, reject) {\n                                    console.info(result);\n                                    vk.api.groups.getById({\n                                            group_ids: result,\n                                            fields: 'members_count,start_date,activity,place'\n                                        })\n                                        .then((data) => {\n                                            console.log(data);\n\n                                            var gID = [];\n                                            var gName = [];\n                                            var gActivity = [];\n                                            var gPhoto = [];\n                                            var gStartdate = [];\n                                            var gLatitude = [];\n                                            var gLongitude = [];\n\n                                            var dataObj = JSON.stringify(data);\n                                            var dataJSON = JSON.parse(dataObj);\n                                            for (var i = 0; i < dataJSON.length; i++) {\n                                                gID.push(dataJSON[i].id);\n                                                var place = dataJSON[i].place;\n                                                if (place) {\n                                                    gLatitude.push(dataJSON[i].place.latitude);\n                                                    gLongitude.push(dataJSON[i].place.longitude);\n                                                } else {\n                                                    gLatitude.push('Адрес неизвестен');\n                                                    gLongitude.push('Адрес неизвестен');\n                                                }\n                                                gName.push(dataJSON[i].name);\n                                                gActivity.push(dataJSON[i].activity);\n                                                gPhoto.push(dataJSON[i].photo_200);\n                                                gStartdate.push(dataJSON[i].start_date);\n                                            }\n\n                                            resolve(gStartdate);\n                                        })\n                                })\n                            })\n                            .then(function (res) {\n                                console.log(res); // запись в базу данных с API\n                            })\n                    })\n            })\n            .catch(error => console.error(error))\n    }\n}\n\n\n\n\nfor (var c = 0; c<CitiesID.length; c++) { // цикл для сбора данных по всем городам\n    for (var j = 0; j<ABC.length; j++) { // цикл для сбора данных по всем поисковым словам\n        setTimeout(parseDataAndRecord(j,c), 4000*(j+1)); // Groups.search\n    }\n}\n//parseDataFromSite();\n\n\n/*auth.run()\n .then((token) => {\n console.log('User token:',token);\n vk.setToken(token);\n\n vk.api.groups.getById({\n group_ids: '137040892,145368412,121232062,140933197,139631659,100506804,135759889',\n fields: 'members_count,start_date,activity,place'\n })\n .then((data) => {\n console.log(data);\n var dataObj = JSON.stringify(data);\n var dataJSON = JSON.parse(dataObj);\n for (var i = 0; i < dataJSON.length; i++) {\n groupID.push(dataJSON[i].id);\n var place = dataJSON[i].place;\n if (place) {\n groupLatitude.push(dataJSON[i].place.latitude);\n groupLongitude.push(dataJSON[i].place.longitude);\n } else {\n groupLatitude.push('Адрес неизвестен');\n groupLongitude.push('Адрес неизвестен');\n }\n groupName.push(dataJSON[i].name);\n groupActivity.push(dataJSON[i].activity);\n groupPhoto.push(dataJSON[i].photo_200);\n groupStartdate.push(dataJSON[i].start_date);\n }\n console.log(groupPhoto);\n })\n })\n .catch((error) => {\n console.error(error);\n });*/\n\n\n\n/*auth.run()\n .then((token) => {\n console.log('User token:',token);\n vk.setToken(token);\n\n vk.api.database.getCities({\n country_id: 1\n })\n .then((cities) => {\n var citiesObj = JSON.stringify(cities);\n var citiesJSON = JSON.parse(citiesObj);\n for (var i = 0; i < citiesJSON.items.length; i++) {\n result.push(citiesJSON.items[i].id)\n }\n console.log(result);\n })\n .catch((error) => {\n console.error(error);\n });\n\n })\n .catch((error) => {\n console.error(error);\n });*/\n\n\n\n/*for(var i = 0; i < 10; i++) {\n setTimeout(LogMe(i), 1000*(i+1)); //получим функцию\n } //видимо хочется не всё сразу через 1 секунду выполнить,\n // а по одному разу за 1 секунду (последний console.log() через 10 секунд)\n\n function LogMe(i){ //т.к. i объявлена здесь (в аргументе это всё равно что объявление var),\n //то она больше не будет ссылкой на i из цикла\n //эта области видимости отправится  к мусорщику сразу после выполнения следующей функции\n return function() {     //вернем новую функцию со своей областью видимости.\n console.log(i);\n };\n }*/\n\n/*function Person() {\n // Конструктор Person() определяет `this` как экземпляр самого себя.\n this.age = 0;\n\n setInterval(function growUp() {\n // Без использования `use strict`, функция growUp() определяет `this`\n // как глобальный объект, который отличается от `this`,\n // определённого конструктором Person().\n this.age++;\n }, 1000);\n }\n var p = new Person();\n console.log(p);*/\n\n"]}