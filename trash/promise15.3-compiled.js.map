{"version":3,"sources":["promise15.3.js"],"names":[],"mappings":"AAAA,IAAI,UAAU,QAAQ,SAAR,CAAd;AACA,IAAI,aAAa,QAAQ,aAAR,CAAjB;AACA,IAAI,MAAM,SAAV;;AAEA,IAAI,GAAJ,CAAQ,WAAW,IAAX,EAAR;AACA,IAAI,GAAJ,CAAQ,WAAW,UAAX,CAAsB,EAAE,UAAU,IAAZ,EAAtB,CAAR;;AAIA,SAAS,YAAT,CAAsB,SAAtB,EAAiC;AAC7B,YAAQ,GAAR,CAAY,qBAAZ;AACA,QAAI,UAAU,IAAI,OAAJ,CAAY,UAAU,OAAV,EAAmB,MAAnB,EAA2B;AACjD,mBAAW,YAAY;AACnB,iBAAK,MAAL,KAAgB,EAAhB,GAAqB,QAAQ,EAAR,CAArB,GAAmC,OAAO,uCAAP,CAAnC;AACH,SAFD,EAEG,IAFH;AAGH,KAJa,CAAd;AAKA,WAAO,OAAP;AACH;;AAED,SAAS,SAAT,CAAmB,IAAnB,EAAyB;AACrB,YAAQ,GAAR,CAAY,IAAZ;AACA,YAAQ,IAAR,CAAa,iBAAb;AACA,WAAO,IAAI,OAAJ,CAAY,UAAU,OAAV,EAAmB,MAAnB,EAA2B;AAC1C,mBAAW,MAAM,QAAQ,EAAR,CAAjB,EAA8B,IAA9B;AACH,KAFM,CAAP;AAGH;;AAED,SAAS,UAAT,CAAoB,OAApB,EAA6B;AACzB,YAAQ,GAAR,CAAY,iBAAZ;AACA,YAAQ,GAAR,CAAY,OAAZ,EAAqB,OAArB;AACH;;AAED,SAAS,OAAT,CAAiB,IAAjB,EAAuB;AACnB,YAAQ,IAAR,CAAa,gBAAb;AACA,WAAO,IAAI,OAAJ,CAAY,UAAU,OAAV,EAAmB,MAAnB,EAA2B;AAC1C,mBAAW,MAAM,QAAQ,IAAR,CAAjB,EAAgC,IAAhC;AACH,KAFM,CAAP;AAGH;;AAIG,WAAW,YAAY;AACnB,OAAG,GAAH,GAAS,UAAT,CAAoB,YAApB,EAAkC,IAAlC,CAAuC,EAAvC,EAA2C,EAAC,IAAG,CAAJ,EAA3C,EAAmD,IAAnD,CAAwD,EAAC,KAAI,CAAL,EAAxD,EAAiE,OAAjE,CAAyE,UAAS,GAAT,EAAc;AACnF,WAAG,GAAH,GAAS,UAAT,CAAoB,YAApB,EAAkC,MAAlC,CAAyC;AACrC,iBAAI,EAAC,KAAI,IAAI,GAAT,EADiC;AAErC,gBAAI,IAAI;AAF6B,SAAzC;AAIH,KALD;AAOH,CARD,EAQG,IARH;;AAcJ,aAAa,EAAb,EACK,IADL,CACU,OADV,EAEK,IAFL,CAEU,SAFV,EAGK,IAHL,CAGU,UAHV,EAIK,KAJL,CAIY,KAAD,IAAW,QAAQ,KAAR,CAAc,KAAd,CAJtB;;AAYA,IAAI,GAAJ,CAAQ,GAAR,EAAa,UAAU,GAAV,EAAe,GAAf,EAAoB;AAC7B,QAAI,IAAJ,CAAS,iBAAT;AACH,CAFD;;AAIA,IAAI,MAAJ,CAAW,IAAX,EAAiB,YAAY;AACzB,YAAQ,GAAR,CAAY,iBAAZ;AACH,CAFD","file":"promise15.3-compiled.js","sourcesContent":["var express = require('express');\nvar bodyParser = require('body-parser');\nvar app = express();\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\n\n\n\nfunction applyForVisa(documents) {\n    console.log('Обработка данных...');\n    let promise = new Promise(function (resolve, reject) {\n        setTimeout(function () {\n            Math.random() > .5 ? resolve({}) : reject('В визе отказано: нехватка документов.');\n        }, 1000);\n    });\n    return promise;\n}\n\nfunction bookHotel(visa) {\n    console.log(visa);\n    console.info('Бронируем отель');\n    return new Promise(function (resolve, reject) {\n        setTimeout(() => resolve({}), 1000)\n    })\n}\n\nfunction buyTeckets(booking) {\n    console.log('Покупаем билеты');\n    console.log('Бронь', booking);\n}\n\nfunction getVisa(visa) {\n    console.info('Виза получена!');\n    return new Promise(function (resolve, reject) {\n        setTimeout(() => resolve(visa), 1000);\n    })\n}\n\n\n\n    setTimeout(function () {\n        db.get().collection('cityevents').find({}, {id:1}).sort({_id:1}).forEach(function(doc) {\n            db.get().collection('cityevents').remove({\n                _id:{$gt:doc._id},\n                id: doc.id\n            })\n        });\n\n    }, 3000)\n\n\n\n\n\napplyForVisa({})\n    .then(getVisa)\n    .then(bookHotel)\n    .then(buyTeckets)\n    .catch((error) => console.error(error))\n\n\n\n\n\n\n\napp.get('/', function (req, res) {\n    res.send(\"Server started!\");\n});\n\napp.listen(3012, function () {\n    console.log(\"API app started\");\n});\n\n\n"]}