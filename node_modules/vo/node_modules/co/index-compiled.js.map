{"version":3,"sources":["index.js"],"names":[],"mappings":";AACA;;;;AAIA,IAAI,QAAQ,MAAM,SAAN,CAAgB,KAA5B;;AAEA;;;;AAIA,OAAO,OAAP,GAAiB,EAAjB;;AAEA;;;;;;;;;AASA,SAAS,EAAT,CAAY,EAAZ,EAAgB;AACd,MAAI,WAAW,oBAAoB,EAApB,CAAf;;AAEA,SAAO,UAAU,IAAV,EAAgB;AACrB,QAAI,MAAM,IAAV;;AAEA;AACA;AACA;AACA,QAAI,MAAM,EAAV;;AAEA;AACA;AACA,QAAI,QAAJ,EAAc;AACZ,UAAI,OAAO,MAAM,IAAN,CAAW,SAAX,CAAX;AAAA,UAAkC,MAAM,KAAK,MAA7C;AACA,UAAI,cAAc,OAAO,cAAc,OAAO,KAAK,MAAM,CAAX,CAA9C;AACA,aAAO,cAAc,KAAK,GAAL,EAAd,GAA2B,KAAlC;AACA,YAAM,GAAG,KAAH,CAAS,IAAT,EAAe,IAAf,CAAN;AACD,KALD,MAKO;AACL,aAAO,QAAQ,KAAf;AACD;;AAED;;AAEA;AACA;AACA;AACA,aAAS,IAAT,CAAc,GAAd,EAAmB,GAAnB,EAAwB;AACtB,mBAAa,YAAU;AACrB,aAAK,IAAL,CAAU,GAAV,EAAe,GAAf,EAAoB,GAApB;AACD,OAFD;AAGD;;AAED,aAAS,IAAT,CAAc,GAAd,EAAmB,GAAnB,EAAwB;AACtB,UAAI,GAAJ;;AAEA;AACA,UAAI,UAAU,MAAV,GAAmB,CAAvB,EAA0B,MAAM,MAAM,IAAN,CAAW,SAAX,EAAsB,CAAtB,CAAN;;AAE1B;AACA,UAAI,GAAJ,EAAS;AACP,YAAI;AACF,gBAAM,IAAI,KAAJ,CAAU,GAAV,CAAN;AACD,SAFD,CAEE,OAAO,CAAP,EAAU;AACV,iBAAO,KAAK,CAAL,CAAP;AACD;AACF;;AAED;AACA,UAAI,CAAC,GAAL,EAAU;AACR,YAAI;AACF,gBAAM,IAAI,IAAJ,CAAS,GAAT,CAAN;AACD,SAFD,CAEE,OAAO,CAAP,EAAU;AACV,iBAAO,KAAK,CAAL,CAAP;AACD;AACF;;AAED;AACA,UAAI,IAAI,IAAR,EAAc,OAAO,KAAK,IAAL,EAAW,IAAI,KAAf,CAAP;;AAEd;AACA,UAAI,KAAJ,GAAY,QAAQ,IAAI,KAAZ,EAAmB,GAAnB,CAAZ;;AAEA;AACA,UAAI,cAAc,OAAO,IAAI,KAA7B,EAAoC;AAClC,YAAI,SAAS,KAAb;AACA,YAAI;AACF,cAAI,KAAJ,CAAU,IAAV,CAAe,GAAf,EAAoB,YAAU;AAC5B,gBAAI,MAAJ,EAAY;AACZ,qBAAS,IAAT;AACA,iBAAK,KAAL,CAAW,GAAX,EAAgB,SAAhB;AACD,WAJD;AAKD,SAND,CAME,OAAO,CAAP,EAAU;AACV,uBAAa,YAAU;AACrB,gBAAI,MAAJ,EAAY;AACZ,qBAAS,IAAT;AACA,iBAAK,CAAL;AACD,WAJD;AAKD;AACD;AACD;;AAED;AACA,WAAK,IAAI,SAAJ,CAAc,0EACf,iCADe,GACqB,OAAO,IAAI,KAAX,CADrB,GACyC,GADvD,CAAL;AAED;AACF,GAnFD;AAoFD;;AAED;;;;;;;;;AASA,SAAS,OAAT,CAAiB,GAAjB,EAAsB,GAAtB,EAA2B;;AAEzB,MAAI,oBAAoB,GAApB,CAAJ,EAA8B;AAC5B,WAAO,GAAG,IAAI,IAAJ,CAAS,GAAT,CAAH,CAAP;AACD;;AAED,MAAI,YAAY,GAAZ,CAAJ,EAAsB;AACpB,WAAO,GAAG,GAAH,CAAP;AACD;;AAED,MAAI,UAAU,GAAV,CAAJ,EAAoB;AAClB,WAAO,eAAe,GAAf,CAAP;AACD;;AAED,MAAI,cAAc,OAAO,GAAzB,EAA8B;AAC5B,WAAO,GAAP;AACD;;AAED,MAAI,SAAS,GAAT,KAAiB,MAAM,OAAN,CAAc,GAAd,CAArB,EAAyC;AACvC,WAAO,cAAc,IAAd,CAAmB,GAAnB,EAAwB,GAAxB,CAAP;AACD;;AAED,SAAO,GAAP;AACD;;AAED;;;;;;;;AAQA,SAAS,aAAT,CAAuB,GAAvB,EAA2B;AACzB,MAAI,MAAM,IAAV;AACA,MAAI,UAAU,MAAM,OAAN,CAAc,GAAd,CAAd;;AAEA,SAAO,UAAS,IAAT,EAAc;AACnB,QAAI,OAAO,OAAO,IAAP,CAAY,GAAZ,CAAX;AACA,QAAI,UAAU,KAAK,MAAnB;AACA,QAAI,UAAU,UACV,IAAI,KAAJ,CAAU,OAAV,CADU,CACS;AADT,MAEV,IAAI,IAAI,WAAR,EAFJ;AAGA,QAAI,QAAJ;;AAEA,QAAI,CAAC,OAAL,EAAc;AACZ,mBAAa,YAAU;AACrB,aAAK,IAAL,EAAW,OAAX;AACD,OAFD;AAGA;AACD;;AAED;AACA,QAAI,CAAC,OAAL,EAAc;AACZ,WAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,OAApB,EAA6B,GAA7B,EAAkC;AAChC,gBAAQ,KAAK,CAAL,CAAR,IAAmB,SAAnB;AACD;AACF;;AAED,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,MAAzB,EAAiC,GAAjC,EAAsC;AACpC,UAAI,IAAI,KAAK,CAAL,CAAJ,CAAJ,EAAkB,KAAK,CAAL,CAAlB;AACD;;AAED,aAAS,GAAT,CAAa,EAAb,EAAiB,GAAjB,EAAsB;AACpB,UAAI,QAAJ,EAAc;AACd,UAAI;AACF,aAAK,QAAQ,EAAR,EAAY,GAAZ,CAAL;;AAEA,YAAI,cAAc,OAAO,EAAzB,EAA6B;AAC3B,kBAAQ,GAAR,IAAe,EAAf;AACA,iBAAO,EAAE,OAAF,IAAa,KAAK,IAAL,EAAW,OAAX,CAApB;AACD;;AAED,WAAG,IAAH,CAAQ,GAAR,EAAa,UAAS,GAAT,EAAc,GAAd,EAAkB;AAC7B,cAAI,QAAJ,EAAc;;AAEd,cAAI,GAAJ,EAAS;AACP,uBAAW,IAAX;AACA,mBAAO,KAAK,GAAL,CAAP;AACD;;AAED,kBAAQ,GAAR,IAAe,GAAf;AACA,YAAE,OAAF,IAAa,KAAK,IAAL,EAAW,OAAX,CAAb;AACD,SAVD;AAWD,OAnBD,CAmBE,OAAO,GAAP,EAAY;AACZ,mBAAW,IAAX;AACA,aAAK,GAAL;AACD;AACF;AACF,GApDD;AAqDD;;AAED;;;;;;;;AAQA,SAAS,cAAT,CAAwB,OAAxB,EAAiC;AAC/B,SAAO,UAAS,EAAT,EAAY;AACjB,YAAQ,IAAR,CAAa,UAAS,GAAT,EAAc;AACzB,SAAG,IAAH,EAAS,GAAT;AACD,KAFD,EAEG,EAFH;AAGD,GAJD;AAKD;;AAED;;;;;;;;AAQA,SAAS,SAAT,CAAmB,GAAnB,EAAwB;AACtB,SAAO,OAAO,cAAc,OAAO,IAAI,IAAvC;AACD;;AAED;;;;;;;;AAQA,SAAS,WAAT,CAAqB,GAArB,EAA0B;AACxB,SAAO,OAAO,cAAc,OAAO,IAAI,IAAhC,IAAwC,cAAc,OAAO,IAAI,KAAxE;AACD;;AAED;;;;;;;;AAQA,SAAS,mBAAT,CAA6B,GAA7B,EAAkC;AAChC,SAAO,OAAO,IAAI,WAAX,IAA0B,uBAAuB,IAAI,WAAJ,CAAgB,IAAxE;AACD;;AAED;;;;;;;;AAQA,SAAS,QAAT,CAAkB,GAAlB,EAAuB;AACrB,SAAO,OAAO,UAAU,IAAI,WAA5B;AACD;;AAED;;;;;;;;;;;;AAYA,SAAS,KAAT,CAAe,GAAf,EAAoB;AAClB,MAAI,CAAC,GAAL,EAAU;AACV,eAAa,YAAU;AACrB,UAAM,GAAN;AACD,GAFD;AAGD","file":"index-compiled.js","sourcesContent":["\n/**\n * slice() reference.\n */\n\nvar slice = Array.prototype.slice;\n\n/**\n * Expose `co`.\n */\n\nmodule.exports = co;\n\n/**\n * Wrap the given generator `fn` and\n * return a thunk.\n *\n * @param {Function} fn\n * @return {Function}\n * @api public\n */\n\nfunction co(fn) {\n  var isGenFun = isGeneratorFunction(fn);\n\n  return function (done) {\n    var ctx = this;\n\n    // in toThunk() below we invoke co()\n    // with a generator, so optimize for\n    // this case\n    var gen = fn;\n\n    // we only need to parse the arguments\n    // if gen is a generator function.\n    if (isGenFun) {\n      var args = slice.call(arguments), len = args.length;\n      var hasCallback = len && 'function' == typeof args[len - 1];\n      done = hasCallback ? args.pop() : error;\n      gen = fn.apply(this, args);\n    } else {\n      done = done || error;\n    }\n\n    next();\n\n    // #92\n    // wrap the callback in a setImmediate\n    // so that any of its errors aren't caught by `co`\n    function exit(err, res) {\n      setImmediate(function(){\n        done.call(ctx, err, res);\n      });\n    }\n\n    function next(err, res) {\n      var ret;\n\n      // multiple args\n      if (arguments.length > 2) res = slice.call(arguments, 1);\n\n      // error\n      if (err) {\n        try {\n          ret = gen.throw(err);\n        } catch (e) {\n          return exit(e);\n        }\n      }\n\n      // ok\n      if (!err) {\n        try {\n          ret = gen.next(res);\n        } catch (e) {\n          return exit(e);\n        }\n      }\n\n      // done\n      if (ret.done) return exit(null, ret.value);\n\n      // normalize\n      ret.value = toThunk(ret.value, ctx);\n\n      // run\n      if ('function' == typeof ret.value) {\n        var called = false;\n        try {\n          ret.value.call(ctx, function(){\n            if (called) return;\n            called = true;\n            next.apply(ctx, arguments);\n          });\n        } catch (e) {\n          setImmediate(function(){\n            if (called) return;\n            called = true;\n            next(e);\n          });\n        }\n        return;\n      }\n\n      // invalid\n      next(new TypeError('You may only yield a function, promise, generator, array, or object, '\n        + 'but the following was passed: \"' + String(ret.value) + '\"'));\n    }\n  }\n}\n\n/**\n * Convert `obj` into a normalized thunk.\n *\n * @param {Mixed} obj\n * @param {Mixed} ctx\n * @return {Function}\n * @api private\n */\n\nfunction toThunk(obj, ctx) {\n\n  if (isGeneratorFunction(obj)) {\n    return co(obj.call(ctx));\n  }\n\n  if (isGenerator(obj)) {\n    return co(obj);\n  }\n\n  if (isPromise(obj)) {\n    return promiseToThunk(obj);\n  }\n\n  if ('function' == typeof obj) {\n    return obj;\n  }\n\n  if (isObject(obj) || Array.isArray(obj)) {\n    return objectToThunk.call(ctx, obj);\n  }\n\n  return obj;\n}\n\n/**\n * Convert an object of yieldables to a thunk.\n *\n * @param {Object} obj\n * @return {Function}\n * @api private\n */\n\nfunction objectToThunk(obj){\n  var ctx = this;\n  var isArray = Array.isArray(obj);\n\n  return function(done){\n    var keys = Object.keys(obj);\n    var pending = keys.length;\n    var results = isArray\n      ? new Array(pending) // predefine the array length\n      : new obj.constructor();\n    var finished;\n\n    if (!pending) {\n      setImmediate(function(){\n        done(null, results)\n      });\n      return;\n    }\n\n    // prepopulate object keys to preserve key ordering\n    if (!isArray) {\n      for (var i = 0; i < pending; i++) {\n        results[keys[i]] = undefined;\n      }\n    }\n\n    for (var i = 0; i < keys.length; i++) {\n      run(obj[keys[i]], keys[i]);\n    }\n\n    function run(fn, key) {\n      if (finished) return;\n      try {\n        fn = toThunk(fn, ctx);\n\n        if ('function' != typeof fn) {\n          results[key] = fn;\n          return --pending || done(null, results);\n        }\n\n        fn.call(ctx, function(err, res){\n          if (finished) return;\n\n          if (err) {\n            finished = true;\n            return done(err);\n          }\n\n          results[key] = res;\n          --pending || done(null, results);\n        });\n      } catch (err) {\n        finished = true;\n        done(err);\n      }\n    }\n  }\n}\n\n/**\n * Convert `promise` to a thunk.\n *\n * @param {Object} promise\n * @return {Function}\n * @api private\n */\n\nfunction promiseToThunk(promise) {\n  return function(fn){\n    promise.then(function(res) {\n      fn(null, res);\n    }, fn);\n  }\n}\n\n/**\n * Check if `obj` is a promise.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isPromise(obj) {\n  return obj && 'function' == typeof obj.then;\n}\n\n/**\n * Check if `obj` is a generator.\n *\n * @param {Mixed} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isGenerator(obj) {\n  return obj && 'function' == typeof obj.next && 'function' == typeof obj.throw;\n}\n\n/**\n * Check if `obj` is a generator function.\n *\n * @param {Mixed} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isGeneratorFunction(obj) {\n  return obj && obj.constructor && 'GeneratorFunction' == obj.constructor.name;\n}\n\n/**\n * Check for plain object.\n *\n * @param {Mixed} val\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(val) {\n  return val && Object == val.constructor;\n}\n\n/**\n * Throw `err` in a new stack.\n *\n * This is used when co() is invoked\n * without supplying a callback, which\n * should only be for demonstrational\n * purposes.\n *\n * @param {Error} err\n * @api private\n */\n\nfunction error(err) {\n  if (!err) return;\n  setImmediate(function(){\n    throw err;\n  });\n}\n"]}