{"version":3,"sources":["wrap.js"],"names":[],"mappings":"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","file":"wrap-compiled.js","sourcesContent":["/**\n * Module Dependencies\n */\n\nvar debug = require('debug')('vo')\nvar sliced = require('sliced')\nvar noop = function(){}\nvar co = require('co')\n\n/**\n * Export `wrapped`\n */\n\nmodule.exports = wrapped\n\n/**\n * Wrap\n */\n\nfunction wrapped(fn, done) {\n  return function wrap(args) {\n    var ctx = this\n\n    debug.enabled && debug(pretty(fn.name || 'anonymous', args))\n\n    // nothing\n    if (!fn) {\n      return next.apply(ctx, [null].concat(args));\n    } else if (generator(fn)) {\n      return co(fn).apply(ctx, args.concat(next))\n    } else {\n      return sync(fn, next).apply(ctx, args)\n    }\n\n    function next () {\n      debug.enabled && debug(pretty(fn.name || 'anonymous', args, sliced(arguments)))\n      return done.apply(this, arguments)\n    }\n  }\n}\n\n/**\n * Wrap a synchronous function execution.\n *\n * @param {Function} fn\n * @param {Function} done\n * @return {Function}\n * @api private\n */\n\nfunction sync(fn, done) {\n  return function () {\n    var ret;\n\n    try {\n      ret = fn.apply(this, arguments);\n    } catch (err) {\n      return done(err);\n    }\n\n    if (promise(ret)) {\n      ret.then(function (value) { done(null, value); }, done);\n    } else {\n      ret instanceof Error ? done(ret) : done(null, ret);\n    }\n  }\n}\n\n/**\n * Is `value` a generator?\n *\n * @param {Mixed} value\n * @return {Boolean}\n * @api private\n */\n\nfunction generator(value) {\n  return (value && value.constructor && 'GeneratorFunction' == value.constructor.name)\n    || (typeof value.next === 'function' && typeof value.throw === 'function')\n}\n\n/**\n * Is `value` a promise?\n *\n * @param {Mixed} value\n * @return {Boolean}\n * @api private\n */\n\nfunction promise(value) {\n  return value && 'function' == typeof value.then;\n}\n\n/**\n * Prettify a function\n *\n * @param {String} name\n * @param {Array} args\n * @return {Function}\n */\n\nfunction pretty (name, inputs, outputs) {\n  inputs = inputs.map(function (input) {\n    return trim(stringify(input), 30)\n  }).join(', ')\n\n  if (outputs) {\n    outputs = '{ ' + outputs.map(function (output) {\n      return trim(stringify(output), 30)\n    }).join(', ') + ' }'\n  }\n\n  if (!outputs) {\n    return '↗ ' + name + '(' + inputs + ')'\n  } else {\n    return '↙ ' + name + '(' + inputs + ') = ' + outputs\n  }\n\n  function trim (str, limit) {\n    if (str.length > limit) {\n      return str.slice(0, limit - 3) + '…'\n    } else {\n      return str\n    }\n  }\n\n  function stringify (mixed) {\n    try {\n      return JSON.stringify(mixed)\n    } catch (e) {\n      return '×'\n    }\n  }\n}\n"]}