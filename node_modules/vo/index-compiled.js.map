{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict'\n\n/**\n * Module Dependencies\n */\n\nvar Pipeline = require('./lib/pipeline')\n// var Promise = require('any-promise')\nvar Stack = require('./lib/stack')\nvar sliced = require('sliced')\nvar isArray = Array.isArray\nvar noop = function () {}\nvar keys = Object.keys\n\n/**\n * Module Exports\n */\n\nmodule.exports = Vo\n\n/**\n * Initialize a `Vo` instance\n *\n * @param {Array|Object|Function, ...}\n * @return {Function}\n */\n\nfunction Vo() {\n  return Vo.pipeline.apply(this, arguments)\n}\n\n/**\n * Pipeline the functions\n *\n * @param {Mixed}\n * @return {Function}\n */\n\nVo.pipeline = function pipeline () {\n  var pipeline = isArray(this) ? sliced(this) : sliced(arguments)\n\n  // run vo\n  return run(function (context, args, done) {\n    Pipeline(pipeline, context, args, function(err, args) {\n      if (err) return done.call(context, err)\n      return done.apply(context, [null].concat(args))\n    })\n  })\n}\n\n/**\n * Stack the functions (middleware style)\n *\n * @param {Mixed}\n * @return {Function}\n */\n\nVo.stack = function stack () {\n  var stack = isArray(this) ? sliced(this) : sliced(arguments)\n\n  // run the stack\n  return run(function (context, args, done) {\n    Stack(stack, context, args, function(err, v) {\n      if (err) return done(err)\n      return done.apply(this, [null].concat(v))\n    })\n  })\n}\n\n/**\n * Compose the functions\n *\n * COMING SOON\n */\n\nVo.compose = function compose () {\n  throw new Error('not implemented yet')\n}\n\n/**\n * Simple wrapper that will allow us\n * to switch between fixed arguments\n * and transform pipelines\n *\n * @param {Function} fn\n * @return {Function}\n */\n\nfunction run (fn) {\n  function vo () {\n    var args = sliced(arguments)\n    var last = args[args.length - 1]\n    var context = this\n\n    if (typeof last === 'function') {\n      var done = args.pop()\n      fn(context, args, done)\n    } else {\n      // return a promise\n      return new Promise(function (success, failure) {\n        fn(context, args, function(err, ret) {\n          if (arguments.length > 2) ret = sliced(arguments, 1)\n          return err ? failure(err) : success(ret)\n        })\n      })\n    }\n  }\n\n  // with \"vo instanceof Vo\"\n  vo.vo = true\n\n  // thenable support\n  vo.then = function (success, failure) {\n    return vo().then(success, failure)\n  }\n\n  vo.catch = function (failure) {\n    return vo().catch(failure)\n  }\n\n  return vo\n}\n\n/**\n * Catch errors\n *\n * @param {Function} fn\n * @return {Function}\n */\n\nVo.catch = function (fn) {\n  // simple wrapper to avoid attaching to the passed-in function\n  function catcher () { return fn }\n  catcher.__catch__ = true\n  return catcher\n}\n"]}