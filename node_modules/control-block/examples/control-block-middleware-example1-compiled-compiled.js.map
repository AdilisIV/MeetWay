{"version":3,"sources":["control-block-middleware-example1-compiled.js"],"names":[],"mappings":"AAAA,SAAS,eAAT,CAAyB,GAAzB,EAA8B,GAA9B,EAAmC,IAAnC,EAAyC;AACxC,QAAO,MAAM,KAAN,CAAY,OAAZ,EAAqB,IAArB,CAAP;;AAEA,UAAS,OAAT,GAAmB;AAClB,SAAO,eAAe,GAAf,EAAoB,KAApB,CAA0B,WAA1B,CAAP;AACA;;AAED,UAAS,WAAT,CAAqB,UAArB,EAAiC;AAChC,MAAI,IAAI,WAAW,eAAX,CAA2B,UAA3B,EAAuC,EAAE,KAAK,IAAP,EAAvC,CAAR;AACA,MAAI,CAAC,EAAE,KAAP,EAAc;AACb,OAAI,SAAJ,CAAc,GAAd;AACA,UAAO,IAAI,GAAJ,CAAQ,6BAA6B,EAAE,MAAvC,CAAP;AACA;;AAED,MAAI,MAAM,EAAE,MAAZ;AACA,MAAI,IAAI,KAAR,EAAe;AACd;AACA;AACA,SAAM,IAAI,KAAJ,CAAU,qCAAV,CAAN;AACA,GAJD,MAIO;AACN;AACA,OAAI,KAAJ,GAAY,IAAZ;AACA,OAAI,IAAJ,GAAW,MAAX,CAHM,CAGa;AACnB,UAAO,QAAQ,eAAR,CAAwB,GAAxB,EAA6B,KAA7B,CAAmC,aAAnC,CAAP;AACA;AACD;;AAED,UAAS,aAAT,CAAuB,SAAvB,EAAkC;AACjC,MAAI,IAAI,WAAW,eAAX,CAA2B,SAA3B,EAAsC,EAAE,KAAK,IAAP,EAAtC,CAAR;AACA,SAAO,YAAY,EAAE,MAAd,EAAsB,GAAtB,CAAP;AACA;AACD;;AAED","file":"control-block-middleware-example1-compiled-compiled.js","sourcesContent":["function handleUserAgent(req, res, next) {\n\treturn Block.begin(process, next);\n\n\tfunction process() {\n\t\treturn jsonifyRequest(req).force(withRequest);\n\t}\n\n\tfunction withRequest(requestObj) {\n\t\tvar r = validators.UserAgentRecord(requestObj, { fix: true });\n\t\tif (!r.valid) {\n\t\t\tres.writeHead(400);\n\t\t\treturn res.end('Invalid request object: ' + r.reason);\n\t\t}\n\n\t\tvar uar = r.object;\n\t\tif (uar.token) {\n\t\t\t// Verify\n\t\t\t//return handler.verifyUserAgent(uar);\n\t\t\tthrow new Error('verifyUserAgent not yet implemented');\n\t\t} else {\n\t\t\t// Create\n\t\t\tuar.token = null;\n\t\t\tuar.type = 'auth'; // TODO: Maybe support unauth in the future?\n\t\t\treturn handler.createUserAgent(uar).force(withUserAgent);\n\t\t}\n\t}\n\n\tfunction withUserAgent(userAgent) {\n\t\tvar r = validators.UserAgentRecord(userAgent, { fix: true });\n\t\treturn respondJson(r.object, res);\n\t}\n}\n\n//# sourceMappingURL=control-block-middleware-example1-compiled.js.map"]}